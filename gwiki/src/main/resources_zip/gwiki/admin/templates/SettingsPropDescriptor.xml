<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<beans>
	<bean id="config"
		class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptor"
		singleton="false">
		<property name="descriptors">
			<list>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="CREATEDAT" />
					<property name="label" value="I{gwiki.settings.CREATEDAT.label}" />
					<property name="description" value="I{gwiki.settings.CREATEDAT.description}" />
					<property name="requiredEditRight" value="GWIKI_ADMIN" />
					<property name="type" value="DATE" />
					<property name="controlerScript">
						<value><![CDATA[
import de.micromata.genome.gwiki.model.GWikiProps;
def onValidate(pec) 
{
	if (pec.requestValue == null || pec.requestValue.length() == 0) {
		pec.setValue(GWikiProps.formatTimeStamp(new java.util.Date()));
	} else {
		// nix
	}
}
							]]></value>
					</property>
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="CREATEDBY" />
					<property name="label" value="I{gwiki.settings.CREATEDBY.label}" />
					<property name="description" value="I{gwiki.settings.CREATEDBY.description}" />
					<property name="requiredEditRight" value="GWIKI_ADMIN" />
					<property name="controlerScript">
						<value><![CDATA[
import de.micromata.genome.gwiki.model.GWikiProps;
def onValidate(pec) 
{
	if (pec.requestValue == null || pec.requestValue.length() == 0) {
		pec.setValue(pec.wikiContext.wikiWeb.authorization.getCurrentUserName(pec.wikiContext));
	} 
}
						]]></value>
					</property>
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="MODIFIEDAT" />
					<property name="label" value="I{gwiki.settings.MODIFIEDAT.label}" />
					<property name="description" value="I{gwiki.settings.MODIFIEDAT.description}" />
					<property name="requiredEditRight" value="GWIKI_ADMIN" />
					<property name="type" value="DATE" />
					<property name="controlerScript">
						<value><![CDATA[
import de.micromata.genome.gwiki.model.GWikiProps;
def onValidate(pec) 
{
		pec.setValue(GWikiProps.formatTimeStamp(new java.util.Date()));
}
							]]>
						</value>
					</property>
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="MODIFIEDBY" />
					<property name="label" value="I{gwiki.settings.MODIFIEDBY.label}" />
					<property name="description" value="I{gwiki.settings.MODIFIEDBY.description}" />
					<property name="requiredEditRight" value="GWIKI_ADMIN" />
					<property name="controlerScript">
						<value><![CDATA[
def onValidate(pec) 
{
		pec.setValue(pec.wikiContext.wikiWeb.authorization.getCurrentUserName(pec.wikiContext));
}
								]]>
						</value>
					</property>
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="TYPE" />
					<property name="label" value="I{gwiki.settings.TYPE.label}" />
					<property name="description" value="I{gwiki.settings.TYPE.description}" />
					<property name="requiredEditRight" value="GWIKI_ADMIN" />
					<property name="requiresValue" value="true" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="PARENTPAGE" />
					<property name="label" value="I{gwiki.settings.PARENTPAGE.label}" />
					<property name="description" value="I{gwiki.settings.PARENTPAGE.description}" />
					<property name="readOnly" value="false" />
					<property name="type" value="PAGEID" />
					<property name="controlerScript">
						<value><![CDATA[
def onValidate(pec) 
{
	
	String pid = pec.getRequestValue();
	if (pid == null || pid.length() == 0){
		return;
	}
	pelInfo = pec.wikiContext.wikiWeb.findElementInfo(pid);
  if (pelInfo  == null) {
  	pec.wikiContext.addSimpleValidationError("Es muss eine gültige PageId als PARENTPAGE angegeben werden");
	} else {
		boolean hasRec = false;
		while (pelInfo != null) {
			if (pelInfo.id.equals(pec.wikiContext.getWikiElement().elementInfo.id) == true) {
				pec.wikiContext.addSimpleValidationError("Recursive Verlinkung über PARENTPAGE entdeckt");
				hasRec = true;
				break;
			}
			pelInfo = pelInfo.getParent(pec.wikiContext);
		} 
		if (hasRec == false) {
			pec.setValue(pid);
		}
	}
}
								]]>
						</value>
					</property>
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="NOINDEX" />
					<property name="label" value="I{gwiki.settings.NOINDEX.label}" />
					<property name="description" value="I{gwiki.settings.NOINDEX.description}" />
					<property name="readOnly" value="false" />
					<property name="type" value="BOOLEAN" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="AUTH_VIEW" />
					<property name="label" value="I{gwiki.settings.AUTH_VIEW.label}" />
					<property name="description" value="I{gwiki.settings.AUTH_VIEW.description}" />
					<property name="readOnly" value="false" />
					<property name="controlerScript">
						<value><![CDATA[
import org.apache.commons.lang.*;
import de.micromata.genome.gwiki.auth.*;
def onRender(pct)
{
	String reqk = pct.getRequestKey();
	String pval = pct.propsValue;
	pct.append('<input type="radio" name="gwiki_auth_view_choice" ');
	if (StringUtils.equals(pval, 'GWIKI_PRIVATE') == true) {
		pct.append(' checked');
	}
	pct.append(' onclick="document.getElementById(\'' + reqk + '\').value = \'GWIKI_PRIVATE\';"> Privat<br/>');
	
	pct.append('<input type="radio" name="gwiki_auth_view_choice" ');
	if (StringUtils.equals(pval, 'GWIKI_PUBLIC') == true) {
		pct.append(' checked');
	}
	pct.append(' onclick="document.getElementById(\'' + reqk + '\').value = \'GWIKI_PUBLIC\';"> Public<br/>');
	
	pct.append('<input type="radio" name="gwiki_auth_view_choice" ');
	if (StringUtils.isEmpty(pval) == true) {
		pct.append(' checked');
	}
	pct.append(' onclick="document.getElementById(\'' + reqk + '\').value = \'\';"> Derived (' + pct.getEffectiveDerivedRight('AUTH_VIEW') + ')<br/>');
	pct.append('<input type="radio" name="gwiki_auth_view_choice" ');
	if (StringUtils.equals(pval, 'GWIKI_PRIVATE') == false && StringUtils.isEmpty(pval) == false) {
		pct.append(' checked'); 
	}
	pct.append(' onclick="document.getElementById(\'' + reqk + '\').value = \'' + pct.propsValue + '\';"> Right: ');
	pct.append('<input type="text" id="' + reqk + '" name="' + pct.requestKey + '" value="' + pct.propsValue + '">');
}

]]></value>
					</property>

				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="AUTH_EDIT" />
					<property name="label" value="I{gwiki.settings.AUTH_EDIT.label}" />
					<property name="description" value="I{gwiki.settings.AUTH_EDIT.description}" />
					<property name="readOnly" value="false" />
					<property name="controlerScript">
						<value><![CDATA[
import org.apache.commons.lang.*;
import de.micromata.genome.gwiki.auth.*;
def onRender(pct)
{
	String reqk = pct.getRequestKey();
	String pval = pct.propsValue;
	pct.append('<input type="radio" name="gwiki_auth_edit_choice" ');
	if (StringUtils.equals(pval, 'GWIKI_PRIVATE') == true) {
		pct.append(' checked');
	}
	pct.append(' onclick="document.getElementById(\'' + reqk + '\').value = \'GWIKI_PRIVATE\';"> Private<br/>');
	
	pct.append('<input type="radio" name="gwiki_auth_edit_choice" ');
	if (StringUtils.isEmpty(pval) == true) {
		pct.append(' checked');
	}
	pct.append(' onclick="document.getElementById(\'' + reqk + '\').value = \'\';"> Derived  (' + pct.getEffectiveDerivedRight('AUTH_EDIT') + ')<br/>');
	pct.append('<input type="radio" name="gwiki_auth_edit_choice" ');
	if (StringUtils.equals(pval, 'GWIKI_PRIVATE') == false && StringUtils.isEmpty(pval) == false) {
		pct.append(' checked'); 
	}
	pct.append(' onclick="document.getElementById(\'' + reqk + '\').value = \'' + pct.propsValue + '\';"> Right: ');
	pct.append('<input type="text" id="' + reqk + '" name="' + pct.requestKey + '" value="' + pct.propsValue + '">');
}

]]></value>
					</property>
				</bean>

				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="CONTENTYPE" />
					<property name="label" value="I{gwiki.settings.CONTENTYPE.label}" />
					<property name="description" value="I{gwiki.settings.CONTENTYPE.description}" />
					<property name="readOnly" value="false" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="LANG" />
					<property name="label" value="I{gwiki.settings.LANG.label}" />
					<property name="description" value="I{gwiki.settings.LANG.description}" />
					<property name="readOnly" value="false" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="ORDER" />
					<property name="label" value="I{gwiki.settings.ORDER.label}" />
					<property name="description" value="I{gwiki.settings.ORDER.description}" />
					<property name="readOnly" value="false" />
					<property name="type" value="INTEGER" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="WIKIMETATEMPLATE" />
					<property name="label" value="I{gwiki.settings.WIKIMETATEMPLATE.label}" />
					<property name="description" value="I{gwiki.settings.WIKIMETATEMPLATE.description}" />
					<property name="readOnly" value="true" />
					<property name="type" value="STRING" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="WIKICONTROLERCLASS" />
					<property name="label" value="I{gwiki.settings.WIKICONTROLERCLASS.label}" />
					<property name="description" value="I{gwiki.settings.WIKICONTROLERCLASS.description}" />
					<property name="readOnly" value="false" />
					<property name="requiredMetaTemplateId"
						value="admin/templates/FullFeaturedMetaTemplate,admin/templates/StdProgMetaTemplate,StdProgMetaTemplate" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="WIKISPACE" />
					<property name="label" value="I{gwiki.settings.WIKISPACE.label}" />
					<property name="description" value="I{gwiki.settings.WIKISPACE.description}" />
					<property name="readOnly" value="false" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="KEYWORDS" />
					<property name="label" value="I{gwiki.settings.KEYWORDS.label}" />
					<property name="description" value="I{gwiki.settings.KEYWORDS.description}" />
					<property name="type" value="STRINGLIST" />
					<property name="controlerScript">
						<value><![CDATA[
import de.micromata.genome.gwiki.page.impl.wiki.filter.GWikiKeywordLoadElementInfosFilter;
def onValidate(pec) 
{
	GWikiKeywordLoadElementInfosFilter.checkKeywordProperties(pec.wikiContext, pec.getPropsValue());
}
							]]>
						</value>
					</property>
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="I18NMODULES" />
					<property name="label" value="I{gwiki.settings.I18NMODULES.label}" />
					<property name="description" value="I{gwiki.settings.I18NMODULES.description}" />
					<property name="type" value="PAGEIDLIST" />
					<property name="requiredViewRight" value="GWIKI_DEVELOPER" />
					<property name="requiredEditRight" value="GWIKI_DEVELOPER" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="NOVIEW" />
					<property name="label" value="I{gwiki.settings.NOVIEW.label}" />
					<property name="description" value="I{gwiki.settings.NOVIEW.description}" />
					<property name="readOnly" value="true" />
					<property name="type" value="BOOLEAN" />
					<property name="defaultValue" value="true" />
					<property name="requiredMetaTemplateId" value="admin/templates/ScriptMacroMetaTemplate" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="MACRO_WITH_BODY" />
					<property name="label" value="I{gwiki.settings.MACRO_WITH_BODY.label}" />
					<property name="description" value="I{gwiki.settings.MACRO_WITH_BODY.description}" />
					<property name="readOnly" value="false" />
					<property name="type" value="BOOLEAN" />
					<property name="requiredMetaTemplateId" value="admin/templates/ScriptMacroMetaTemplate" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="MACRO_EVAL_BODY" />
					<property name="label" value="I{gwiki.settings.MACRO_EVAL_BODY.label}" />
					<property name="description" value="I{gwiki.settings.MACRO_EVAL_BODY.description}" />
					<property name="readOnly" value="false" />
					<property name="type" value="BOOLEAN" />
					<property name="requiredMetaTemplateId" value="admin/templates/ScriptMacroMetaTemplate" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="MACRO_WITH_PREVIEW" />
					<property name="label" value="I{gwiki.settings.MACRO_WITH_PREVIEW.label}" />
					<property name="description" value="I{gwiki.settings.MACRO_WITH_PREVIEW.description}" />
					<property name="readOnly" value="false" />
					<property name="type" value="BOOLEAN" />
					<property name="requiredMetaTemplateId" value="admin/templates/ScriptMacroMetaTemplate" />
				</bean>
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="MACRO_ARGUMENTS" />
					<property name="label" value="I{gwiki.settings.MACRO_ARGUMENTS.label}" />
					<property name="description" value="I{gwiki.settings.MACRO_ARGUMENTS.description}" />
					<property name="readOnly" value="false" />
					<property name="type" value="STRINGLIST" />
					<property name="requiredMetaTemplateId" value="admin/templates/ScriptMacroMetaTemplate" />
				</bean>
				
				<bean
					class="de.micromata.genome.gwiki.page.impl.GWikiPropsDescriptorValue">
					<property name="key" value="SIZE" />
					<property name="label" value="I{gwiki.settings.SIZE.label}" />
					<property name="description" value="I{gwiki.settings.SIZE.description}" />
					<property name="readOnly" value="true" />
					<property name="type" value="INTEGER" />
					<property name="requiredMetaTemplateId" value="admin/templates/FileWikiPageMetaTemplate" />
				</bean>
				
			</list>
		</property>
	</bean>
</beans>